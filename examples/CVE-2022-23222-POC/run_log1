jainil@jainil-dellg:~/Draco/DRACO-verifier/examples/CVE-2022-23222-POC$ make symbex-cve-2022-2322 
# compile the program
clang-13 \
        -DKLEE_VERIFICATION\
        -DVERIFY_INTERACTIONS\
        -DKLEE_SYM_PRINTF \
        -I/home/jainil/Draco/DRACO-verifier/examples/CVE-2022-23222-POC/../headers/ -I /usr/include/x86_64-linux-gnu -I/home/jainil/Draco/DRACO-verifier/examples/../ebpf-se/libbpf-stubbed/src/build/usr/include/  \
        -I /home/jainil/Draco/DRACO-verifier/klee/include \
        -D__USE_VMLINUX__ \
        -D__TARGET_ARCH_x86 \
        -DBPF_NO_PRESERVE_ACCESS_INDEX \
        -Wall \
        -Wno-unused-value \
        -Wno-unused-variable \
        -Wno-pointer-sign \
        -Wno-compare-distinct-pointer-types \
        -Werror \
        -fno-discard-value-names \
        -fno-builtin \
        -O0 -emit-llvm -c -g exploit.c
llvm-dis -show-annotations exploit.bc
sudo /home/jainil/Draco/DRACO-verifier/klee/build/bin/klee -kdalloc -kdalloc-heap-start-address=0x00040000000 -kdalloc-heap-size=1 -libc=uclibc --external-calls=all --disable-verify \
        -solver-backend=z3 --exit-on-error -max-memory=750000 -search=dfs -single-object-resolution=true -link-llvm-lib=/home/jainil/Draco/DRACO-verifier/ebpf-se/libbpf-stubbed/src/obj/libbpf.bc \
        -verification=true exploit.bc
KLEE: NOTE: Using klee-uclibc : /home/jainil/Draco/DRACO-verifier/klee/build/runtime/lib/klee-uclibc.bca
KLEE: output directory is "/home/jainil/Draco/DRACO-verifier/examples/CVE-2022-23222-POC/klee-out-0"
KLEE: Using Z3 solver backend
KLEE: Deterministic allocator: Using quarantine queue size 8
KLEE: Deterministic allocator: globals (start-address=0x7c251be00000 size=10 GiB)
KLEE: Deterministic allocator: constants (start-address=0x7c229be00000 size=10 GiB)
KLEE: Deterministic allocator: heap (start-address=0x40000000 size=1 GiB)
KLEE: Deterministic allocator: stack (start-address=0x7c029be00000 size=128 GiB)
KLEE: WARNING ONCE: unsupported intrinsic llvm.vector.reduce.add.v4i32
WARNING: this target does not support the llvm.stacksave intrinsic.
KLEE: WARNING: undefined reference to function: __ctype_b_loc
KLEE: WARNING: undefined reference to function: __isoc23_strtoull
KLEE: WARNING: undefined reference to function: __isoc99_fscanf
KLEE: WARNING: undefined reference to function: __isoc99_sscanf
KLEE: WARNING: undefined reference to function: __syscall_rt_sigaction
KLEE: WARNING: undefined reference to function: _stdio_init
KLEE: WARNING: undefined reference to function: bcmp
KLEE: WARNING: undefined reference to function: clock_gettime
KLEE: WARNING: undefined reference to function: close
KLEE: WARNING: undefined reference to function: dup3
KLEE: WARNING: undefined reference to function: elf64_getehdr
KLEE: WARNING: undefined reference to function: elf64_getshdr
KLEE: WARNING: undefined reference to function: elf64_newehdr
KLEE: WARNING: undefined reference to function: elf_begin
KLEE: WARNING: undefined reference to function: elf_end
KLEE: WARNING: undefined reference to function: elf_errmsg
KLEE: WARNING: undefined reference to function: elf_getdata
KLEE: WARNING: undefined reference to function: elf_getphdrnum
KLEE: WARNING: undefined reference to function: elf_getscn
KLEE: WARNING: undefined reference to function: elf_getshdrnum
KLEE: WARNING: undefined reference to function: elf_getshdrstrndx
KLEE: WARNING: undefined reference to function: elf_kind
KLEE: WARNING: undefined reference to function: elf_memory
KLEE: WARNING: undefined reference to function: elf_ndxscn
KLEE: WARNING: undefined reference to function: elf_newdata
KLEE: WARNING: undefined reference to function: elf_newscn
KLEE: WARNING: undefined reference to function: elf_nextscn
KLEE: WARNING: undefined reference to function: elf_rawdata
KLEE: WARNING: undefined reference to function: elf_strptr
KLEE: WARNING: undefined reference to function: elf_update
KLEE: WARNING: undefined reference to function: elf_version
KLEE: WARNING: undefined reference to function: epoll_create1
KLEE: WARNING: undefined reference to function: epoll_ctl
KLEE: WARNING: undefined reference to function: epoll_wait
KLEE: WARNING: undefined reference to function: execve
KLEE: WARNING: undefined reference to function: faccessat
KLEE: WARNING: undefined reference to function: fcntl
KLEE: WARNING: undefined reference to function: fcntl64
KLEE: WARNING: undefined reference to function: fmemopen
KLEE: WARNING: undefined reference to function: fopen64
KLEE: WARNING: undefined reference to function: fseeko64
KLEE: WARNING: undefined reference to function: fstat
KLEE: WARNING: undefined reference to function: ftello64
KLEE: WARNING: undefined reference to function: gelf_getclass
KLEE: WARNING: undefined reference to function: gelf_getehdr
KLEE: WARNING: undefined reference to function: gelf_getnote
KLEE: WARNING: undefined reference to function: gelf_getphdr
KLEE: WARNING: undefined reference to function: gelf_getshdr
KLEE: WARNING: undefined reference to function: gelf_getsym
KLEE: WARNING: undefined reference to function: gzclose
KLEE: WARNING: undefined reference to function: gzgets
KLEE: WARNING: undefined reference to function: gzopen64
KLEE: WARNING: undefined reference to function: ioctl
KLEE: WARNING: undefined reference to function: lseek64
KLEE: WARNING: undefined reference to function: mkdir
KLEE: WARNING: undefined reference to function: mmap64
KLEE: WARNING: undefined reference to function: munmap
KLEE: WARNING: undefined reference to function: nanosleep
KLEE: WARNING: undefined reference to function: open
KLEE: WARNING: undefined reference to function: open64
KLEE: WARNING: undefined reference to function: read
KLEE: WARNING: undefined reference to function: readlink
KLEE: WARNING: undefined reference to function: setrlimit64
KLEE: WARNING: undefined reference to function: sigprocmask
KLEE: WARNING: undefined reference to function: snprintf
KLEE: WARNING: undefined reference to function: sprintf
KLEE: WARNING: undefined reference to function: statfs64
KLEE: WARNING: undefined reference to function: syscall
KLEE: WARNING: undefined reference to function: time
KLEE: WARNING: undefined reference to function: unlink
KLEE: WARNING: undefined reference to function: vfork
KLEE: WARNING: undefined reference to function: vsnprintf
KLEE: WARNING: undefined reference to function: wait4
KLEE: WARNING: undefined reference to function: write
KLEE: WARNING: undefined reference to function: kill (UNSAFE)!
KLEE: WARNING ONCE: calling __user_main with extra arguments.
KLEE: WARNING ONCE: calling external: syscall(321, 0, 136404334018560, 144) at exploit.c:55 12
KLEE: WARNING ONCE: calling external: printf(136492649283584, 12) at exploit.c:253 8
Return from syscall : 12
[+] eBPF enabled, ringbuf created!
[!] staring to create new maps until we get two consecutive maps
[+] created map 1
KLEE: WARNING ONCE: calling external: open(136492112412672, 0) at exploit.c:164 9
KLEE: WARNING ONCE: calling external: read(14, 136375879860224, 8) at exploit.c:172 17
[+] generated random value: 1b807d611c5d5c51
[+] created map 2
[+] generated random value: b9f68fe8c74971ea
[+] two new maps created!
KLEE: WARNING ONCE: Alignment of memory from call "calloc" is not modelled. Using alignment of 8.
KLEE: WARNING ONCE: calling external: getpagesize() at ringbuf.c:196 18
KLEE: WARNING ONCE: calling external: epoll_create1(524288) at ringbuf.c:198 6
KLEE: WARNING ONCE: Alignment of memory from call "realloc" is not modelled. Using alignment of 8.
KLEE: WARNING ONCE: calling external: mmap64(0, 4096, 3, 1, 12, 0) at ringbuf.c:0 0
KLEE: WARNING ONCE: calling external: epoll_ctl(17, 1, 12, 1308622848) at ringbuf.c:153 56
KLEE: WARNING ONCE: calling external: write(1, 136453725093888, 862) at libc/stdio/_WRITE.c:52 11
func#0 @0
0: R1=ctx() R10=fp0
0: (bf) r8 = r1                       ; R1=ctx() R8_w=ctx()
1: (18) r1 = 0xffff963a264e1000       ; R1_w=map_ptr(ks=0,vs=0)
3: (b7) r2 = 0                        ; R2_w=0
4: (b7) r3 = -1                       ; R3_w=-1
5: (85) call bpf_ringbuf_reserve#131
mark_precise: frame0: last_idx 5 first_idx 0 subseq_idx -1 
mark_precise: frame0: regs=r2 stack= before 4: (b7) r3 = -1
mark_precise: frame0: regs=r2 stack= before 3: (b7) r2 = 0
6: R0_w=ringbuf_mem_or_null(id=2,ref_obj_id=2,sz=0) refs=2
6: (bf) r7 = r0                       ; R0_w=ringbuf_mem_or_null(id=2,ref_obj_id=2,sz=0) R7_w=ringbuf_mem_or_null(id=2,ref_obj_id=2,sz=0) refs=2
7: (07) r7 += 1031
R7 pointer arithmetic on ringbuf_mem_or_null prohibited, null-check it first
processed 7 insns (limit 1000000) max_states_per_insn 0 total_states 0 peak_states 0 mark_read 0

KLEE: WARNING ONCE: calling external: close(0) at exploit.c:151 11
[-] failed to run eBPF program!
[+] value read from slab: 0
func#0 @0
0: R1=ctx() R10=fp0
0: (bf) r8 = r1                       ; R1=ctx() R8_w=ctx()
1: (18) r1 = 0xffff963a264e1000       ; R1_w=map_ptr(ks=0,vs=0)
3: (b7) r2 = 0                        ; R2_w=0
4: (b7) r3 = -1                       ; R3_w=-1
5: (85) call bpf_ringbuf_reserve#131
mark_precise: frame0: last_idx 5 first_idx 0 subseq_idx -1 
mark_precise: frame0: regs=r2 stack= before 4: (b7) r3 = -1
mark_precise: frame0: regs=r2 stack= before 3: (b7) r2 = 0
6: R0_w=ringbuf_mem_or_null(id=2,ref_obj_id=2,sz=0) refs=2
6: (bf) r7 = r0                       ; R0_w=ringbuf_mem_or_null(id=2,ref_obj_id=2,sz=0) R7_w=ringbuf_mem_or_null(id=2,ref_obj_id=2,sz=0) refs=2
7: (07) r7 += 1031
R7 pointer arithmetic on ringbuf_mem_or_null prohibited, null-check it first
processed 7 insns (limit 1000000) max_states_per_insn 0 total_states 0 peak_states 0 mark_read 0

[-] failed to run eBPF program!
[+] value read from slab: 0
[+] created map 3
[+] generated random value: 2af2e5d60462828c
[+] created map 4
[+] generated random value: 164452f0ee23c941
[+] eBPF enabled, maps created!
func#0 @0
0: R1=ctx() R10=fp0
0: (bf) r8 = r1                       ; R1=ctx() R8_w=ctx()
1: (18) r1 = 0xffff963a264e1000       ; R1_w=map_ptr(ks=0,vs=0)
3: (b7) r2 = 0                        ; R2_w=0
4: (b7) r3 = -1                       ; R3_w=-1
5: (85) call bpf_ringbuf_reserve#131
mark_precise: frame0: last_idx 5 first_idx 0 subseq_idx -1 
mark_precise: frame0: regs=r2 stack= before 4: (b7) r3 = -1
mark_precise: frame0: regs=r2 stack= before 3: (b7) r2 = 0
6: R0_w=ringbuf_mem_or_null(id=2,ref_obj_id=2,sz=0) refs=2
6: (bf) r7 = r0                       ; R0_w=ringbuf_mem_or_null(id=2,ref_obj_id=2,sz=0) R7_w=ringbuf_mem_or_null(id=2,ref_obj_id=2,sz=0) refs=2
7: (07) r7 += 1031
R7 pointer arithmetic on ringbuf_mem_or_null prohibited, null-check it first
processed 7 insns (limit 1000000) max_states_per_insn 0 total_states 0 peak_states 0 mark_read 0

[-] failed to run eBPF program!
[+] value read from slab: 0
func#0 @0
0: R1=ctx() R10=fp0
0: (bf) r8 = r1                       ; R1=ctx() R8_w=ctx()
1: (18) r1 = 0xffff963a264e1000       ; R1_w=map_ptr(ks=0,vs=0)
3: (b7) r2 = 0                        ; R2_w=0
4: (b7) r3 = -1                       ; R3_w=-1
5: (85) call bpf_ringbuf_reserve#131
mark_precise: frame0: last_idx 5 first_idx 0 subseq_idx -1 
mark_precise: frame0: regs=r2 stack= before 4: (b7) r3 = -1
mark_precise: frame0: regs=r2 stack= before 3: (b7) r2 = 0
6: R0_w=ringbuf_mem_or_null(id=2,ref_obj_id=2,sz=0) refs=2
6: (bf) r7 = r0                       ; R0_w=ringbuf_mem_or_null(id=2,ref_obj_id=2,sz=0) R7_w=ringbuf_mem_or_null(id=2,ref_obj_id=2,sz=0) refs=2
7: (07) r7 += 1031
R7 pointer arithmetic on ringbuf_mem_or_null prohibited, null-check it first
processed 7 insns (limit 1000000) max_states_per_insn 0 total_states 0 peak_states 0 mark_read 0

[-] failed to run eBPF program!
[+] value read from slab: 0
[+] created map 5
[+] generated random value: a3e0b89850047368
[+] created map 6
[+] generated random value: c8a204e56d620e0e
[+] eBPF enabled, maps created!
func#0 @0
0: R1=ctx() R10=fp0
0: (bf) r8 = r1                       ; R1=ctx() R8_w=ctx()
1: (18) r1 = 0xffff963a264e1000       ; R1_w=map_ptr(ks=0,vs=0)
3: (b7) r2 = 0                        ; R2_w=0
4: (b7) r3 = -1                       ; R3_w=-1
5: (85) call bpf_ringbuf_reserve#131
mark_precise: frame0: last_idx 5 first_idx 0 subseq_idx -1 
mark_precise: frame0: regs=r2 stack= before 4: (b7) r3 = -1
mark_precise: frame0: regs=r2 stack= before 3: (b7) r2 = 0
6: R0_w=ringbuf_mem_or_null(id=2,ref_obj_id=2,sz=0) refs=2
6: (bf) r7 = r0                       ; R0_w=ringbuf_mem_or_null(id=2,ref_obj_id=2,sz=0) R7_w=ringbuf_mem_or_null(id=2,ref_obj_id=2,sz=0) refs=2
7: (07) r7 += 1031
R7 pointer arithmetic on ringbuf_mem_or_null prohibited, null-check it first
processed 7 insns (limit 1000000) max_states_per_insn 0 total_states 0 peak_states 0 mark_read 0

[-] failed to run eBPF program!
[+] value read from slab: 0
^CKLEE: ctrl-c detected, requesting interpreter to halt.
KLEE: halting execution, dumping remaining states
KLEE: ERROR: EXITING ON ERROR:
Execution halting.


make: *** [../Makefile:261: symbex-cve-2022-2322] Error 1